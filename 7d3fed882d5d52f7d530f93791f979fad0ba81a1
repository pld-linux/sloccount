- completly rewrited in PLD style and updated to 2.21.

Based on spec from MDK.
